<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>ADP/ACP Nondiscrimination Test & Correction Calculator</title>
   <link rel="stylesheet" href="adp_acp_tester.css">
   
   <link rel="stylesheet" href="../iframe_content_styles.css"> 

   
</head>
<body>

   <div class="calculator-container">
       
      
           <h1>ADP/ACP Nondiscrimination Test & Correction Calculator</h1>
           <p class="description">Calculates the ADP/ACP test results and determines the required corrective distribution/refund for Highly Compensated Employees (HCEs).</p>
       

       <div class="card input-card">
           <h2>Test Inputs</h2>
           
           <div class="input-group">
               <label for="nhceAdp">NHCE Average Deferral Percentage (ADP) (%)</label>
               <input type="number" id="nhceAdp" value="4.0" min="0" max="100" step="0.01">
               <small class="hint-text">The calculated ADP for the Non-Highly Compensated Employee group.</small>
           </div>
           
           <div class="input-group">
               <label for="nhceAcp">NHCE Average Contribution Percentage (ACP) (%)</label>
               <input type="number" id="nhceAcp" value="3.0" min="0" max="100" step="0.01">
               <small class="hint-text">The calculated ACP for the NHCE group (Matching/After-Tax Contributions).</small>
           </div>

           <hr>
           
           <h2>HCE Data Entry Table</h2>
           <p class="hint-text">Input Compensation, Deferrals (for ADP), and Match/After-Tax (for ACP) for each HCE.</p>

           <table id="hceDataTable">
               <thead>
                   <tr>
                       <th>HCE</th>
                       <th>Comp ($)</th>
                       <th>Deferrals ($)</th>
                       <th>Match/After-Tax ($)</th>
                       <th><button onclick="removeHCE(this)" disabled>üóëÔ∏è</button></th>
                   </tr>
               </thead>
               <tbody id="hceTableBody">
                   </tbody>
           </table>

           <button onclick="addHCE()" class="btn-secondary">Add HCE</button>
           
           <button onclick="runAdpAcpTests()" class="btn-primary">Run ADP/ACP Tests & Calculate Refunds</button>
       </div>

       <div class="card result-card" id="adpResults" style="display: none;">
           <h2>ADP Test Results & Correction</h2>
           <div id="adpSummary"></div>
           <table id="adpCorrectionTable" class="correction-table">
               <thead>
                   <tr>
                       <th>HCE</th>
                       <th>Original ADP (%)</th>
                       <th>Required Refund ($)</th>
                       <th>New ADP (%)</th>
                   </tr>
               </thead>
               <tbody id="adpCorrectionBody"></tbody>
           </table>
       </div>

       <div class="card result-card" id="acpResults" style="display: none;">
           <h2>ACP Test Results & Correction</h2>
           <div id="acpSummary"></div>
           <table id="acpCorrectionTable" class="correction-table">
               <thead>
                   <tr>
                       <th>HCE</th>
                       <th>Original ACP (%)</th>
                       <th>Required Refund/Forfeit ($)</th>
                       <th>New ACP (%)</th>
                   </tr>
               </thead>
               <tbody id="acpCorrectionBody"></tbody>
           </table>
       </div>

       <div id="error-message" class="error-message"></div>

       <div class="card result-card" id="acpResults" style="display: none;">

       </div>
       <div class="card result-card" id="adpResults" style="display: none;">
       </div>
<!-- 
       <table id="hceDataTable" class="data-grid-table">

       </table>
       <table id="adpCorrectionTable" class="correction-table">

       </table>
       
       <!-- Your export button needs to be defined once -->
       <div id="calculator-content"> 
           <button id="export-button" class="btn btn-primary">
               Export Results to PDF
           </button>
       </div>
   </div>

   <!-- Script Includes (Must be at the end of the body) -->
   <script src="adp_acp_tester.js"></script>
  
   <!-- Ensure html2canvas is included for visual rendering -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
   
   <!-- jsPDF Core (needed for document creation) -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
   
   <!-- AutoTable is not strictly needed for the visual method, but won't hurt -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
   
   <!-- Your reusable utility file -->
   <script src="../pdf_export_utils.js"></script>

</body>
</html>
